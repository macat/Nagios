<service-templates>
    <generic-templates>
        <generic-host>ML-generic-host</generic-host>
        <generic-service>ML-generic-service</generic-service>
    </generic-templates>
    
    <excludes>
     <!-- Example global resource exclusions
        <exclude resourcetype="Databases" name="MyDatabase" />
        <exclude resourcetype="Servers" name="MyServer?group-id=MyGroup"/>
        <exclude resourcetype="Hosts" name="myhost.marklogic.com"/>
     --> 
    </excludes>
    
    <service-template type="Local-Cluster" refresh="60">
        <service_description>database-count</service_description>
        <service_note>Count of Databases on the cluster</service_note>
        <check-command>check_command   check_marklogic.pl! -a $_HOSTMLUSERPW$  -port $_HOSTMLPORT$  --host $_HOSTMLIP$ -path /manage/v1/databases -key list-count</check-command>
        <threshold>
            <default-warning>$DatabasesCount</default-warning>
        </threshold>
     </service-template>

    <service-template type="Local-Cluster" refresh="60">
        <service_description>server-count</service_description>
        <service_note>Count of App Servers on the cluster</service_note>
        <check-command>check_command   check_marklogic.pl! -a $_HOSTMLUSERPW$  -port $_HOSTMLPORT$  --host $_HOSTMLIP$ -path /manage/v1/servers -key list-count</check-command>
        <threshold>
            <default-warning>$ServerCount</default-warning>
        </threshold>
     </service-template>
     
     <service-template type="Local-Cluster" refresh="60">
        <service_description>host-count</service_description>
        <service_note>Count of Hosts in the cluster</service_note>
        <check-command>check_command   check_marklogic.pl! -a $_HOSTMLUSERPW$  -port $_HOSTMLPORT$  --host $_HOSTMLIP$ -path /manage/v1/hosts -key list-count</check-command>
        <threshold>
            <default-warning>$HostCount</default-warning>
        </threshold>
     </service-template>

     <service-template type="Local-Cluster" refresh="60">
        <service_description>foreign-cluster-count</service_description>
        <service_note>Count of coupled foreign clusters</service_note>
        <check-command>check_command   check_marklogic.pl! -a $_HOSTMLUSERPW$  -port $_HOSTMLPORT$  --host $_HOSTMLIP$ -path /manage/v1/clusters?cluster-role=foreign -key list-count</check-command>
        <threshold>
            <default-warning>$ClusterCount</default-warning>
        </threshold>
     </service-template>

     <service-template type="Foreign-Clusters" refresh="10">
        <service_description>is-bootstrapped</service_description>
        <service_note>Local cluster bootstrapped with foreign cluster</service_note>
        <check-command>check_command   check_marklogic.pl! -a $_HOSTMLUSERPW$  -port $_HOSTMLPORT$  --host $_HOSTMLIP$ -path /manage/v1/clusters/$_HOSTMLALIAS$/status -key $SERVICEDESC$ -op eq=true</check-command>
        <threshold>
            <default-warning>@0:0</default-warning>
        </threshold>
     </service-template>

    <service-template type="Servers" refresh="default">
        <service_description>total-requests</service_description>
        <service_note>Count of total requests</service_note>
        <check-command>check_command   check_marklogic.pl! -a $_HOSTMLUSERPW$  -port $_HOSTMLPORT$  --host $_HOSTMLIP$ -path  /manage/v1/requests?server-id=$_HOSTMLALIAS$\\&amp;seconds-min=60 -key $SERVICEDESC$</check-command>
        <threshold>
            <default-warning>@1:10</default-warning>
            <default-critical>10</default-critical>
        </threshold>    
    </service-template>
    
    <service-template type="Servers" refresh="default">
        <service_description>request-rate</service_description>
        <service_note>Request rate</service_note>
        <check-command>check_command   check_marklogic.pl! -a $_HOSTMLUSERPW$  -port $_HOSTMLPORT$  --host $_HOSTMLIP$ -path  /manage/v1/servers/$_HOSTMLALIAS$\\&amp;view=status -key $SERVICEDESC$</check-command>
    </service-template>
    
    <service-template type="Servers" refresh="default">
        <service_description>expanded-tree-cache-hits</service_description>
        <service_note>Expanded Tree Cache Hit Rate</service_note>
        <check-command>check_command   check_marklogic.pl! -a $_HOSTMLUSERPW$  -port $_HOSTMLPORT$  --host $_HOSTMLIP$ -path  /manage/v1/servers/$_HOSTMLALIAS$\\&amp;view=status -key $SERVICEDESC$</check-command>
    </service-template>
    
    <service-template type="Servers" refresh="default">
        <service_description>expanded-tree-cache-misses</service_description>
        <service_note>Expanded Tree Cache Miss Rate</service_note>
        <check-command>check_command   check_marklogic.pl! -a $_HOSTMLUSERPW$  -port $_HOSTMLPORT$  --host $_HOSTMLIP$ -path  /manage/v1/servers/$_HOSTMLALIAS$\\&amp;view=status -key  $SERVICEDESC$</check-command>
    </service-template>
    
    <service-template type="Servers" refresh="default">
        <service_description>query-count</service_description>
        <service_note>Count of active query requests (vs updates)</service_note>
        <check-command>check_command   check_marklogic.pl! -a $_HOSTMLUSERPW$  -port $_HOSTMLPORT$  --host $_HOSTMLIP$ -path  /manage/v1/requests?server-id=$_HOSTMLALIAS$ -key $SERVICEDESC$</check-command>
    </service-template>
    
    <service-template type="Servers" refresh="default">
        <service_description>update-count</service_description>
        <service_note>Count of active update requests (vs query requests)</service_note>
        <check-command>check_command   check_marklogic.pl! -a $_HOSTMLUSERPW$  -port $_HOSTMLPORT$  --host $_HOSTMLIP$ -path  /manage/v1/requests?server-id=$_HOSTMLALIAS$ -key $SERVICEDESC$</check-command>
    </service-template>
    
    <service-template type="Databases" refresh="default">
        <service_description>state</service_description>
        <service_note>State of the database</service_note>
        <check-command>check_command   check_marklogic.pl! -a $_HOSTMLUSERPW$  -port $_HOSTMLPORT$  --host $_HOSTMLIP$ -path  /manage/v1/databases/$_HOSTMLALIAS$/status -key $SERVICEDESC$ -op ne=unavailable</check-command>
        <threshold>
            <default-critical>@0:0</default-critical>
        </threshold>
     </service-template>
    
    <service-template type="Databases" refresh="10">
        <service_description>failed-masters</service_description>
        <service_note>Local Disk Failover (failed-masters)</service_note>
        <check-command>check_command   check_marklogic.pl! -a $_HOSTMLUSERPW$  -port $_HOSTMLPORT$  --host $_HOSTMLIP$ -path  /manage/v1/databases/$_HOSTMLALIAS$/status -key $SERVICEDESC$ </check-command>
        <threshold>
            <default-critical>0:0</default-critical>
        </threshold>
     </service-template>
 
     <service-template type="Databases" refresh="10">
        <service_description>async-replicating</service_description>
        <service_note>Local Disk Failover (async-replicating)</service_note>
        <check-command>check_command   check_marklogic.pl! -a $_HOSTMLUSERPW$  -port $_HOSTMLPORT$  --host $_HOSTMLIP$ -path  /manage/v1/databases/$_HOSTMLALIAS$/status -key $SERVICEDESC$ </check-command>
        <threshold>
            <default-critical>0:0</default-critical>
        </threshold>
     </service-template>
    
     <service-template type="Databases" refresh="10">
        <service_description>database-replication-active</service_description>
        <service_note>Database Replication active</service_note>
        <check-command>check_command   check_marklogic.pl! -a $_HOSTMLUSERPW$  -port $_HOSTMLPORT$  --host $_HOSTMLIP$ -path  /manage/v1/databases/$_HOSTMLALIAS$/status -key $SERVICEDESC$ -op eq=true</check-command>
        <threshold>
            <default-critical>@0:0</default-critical>
        </threshold>
     </service-template>

     <service-template type="Databases" refresh="10">
        <service_description>foreign-forests-lag-exceeded</service_description>
        <service_note>Database Replication foreign forest lag exceeded</service_note>
        <check-command>check_command   check_marklogic.pl! -a $_HOSTMLUSERPW$  -port $_HOSTMLPORT$  --host $_HOSTMLIP$ -path  /manage/v1/databases/$_HOSTMLALIAS$/status -key $SERVICEDESC$</check-command>
        <threshold>
            <default-warning>0:0</default-warning>
        </threshold>
     </service-template>
    
    <service-template type="Databases" refresh="default">
        <service_description>backup-count</service_description>
        <service_note>Number of backups in progress</service_note>
        <check-command>check_command   check_marklogic.pl! -a $_HOSTMLUSERPW$  -port $_HOSTMLPORT$  --host $_HOSTMLIP$ -path  /manage/v1/databases/$_HOSTMLALIAS$/status -key $SERVICEDESC$</check-command>
    </service-template>

    <service-template type="Databases" refresh="default">
        <service_description>compressed-tree-cache-miss-rate</service_description>
        <service_note>Average number of misses on the compressed tree cache</service_note>
        <check-command>check_command   check_marklogic.pl! -a $_HOSTMLUSERPW$  -port $_HOSTMLPORT$  --host $_HOSTMLIP$ -path  /manage/v1/databases/$_HOSTMLALIAS$/status -key $SERVICEDESC$</check-command>
    </service-template>

    <service-template type="Databases" refresh="default">
        <service_description>compressed-tree-cache-hit-rate</service_description>
        <service_note>Average number of hits on the compressed tree cache</service_note>
        <check-command>check_command   check_marklogic.pl! -a $_HOSTMLUSERPW$  -port $_HOSTMLPORT$  --host $_HOSTMLIP$ -path  /manage/v1/databases/$_HOSTMLALIAS$/status -key $SERVICEDESC$</check-command>
     </service-template>

    <service-template type="Databases" refresh="60">
        <service_description>documents</service_description>
        <service_note>Document count for attached forests (excluding replicas)</service_note>
        <check-command>check_command   check_marklogic.pl! -a $_HOSTMLUSERPW$  -port $_HOSTMLPORT$  --host $_HOSTMLIP$ -path  /manage/v1/databases/$_HOSTMLALIAS$/counts -key $SERVICEDESC$</check-command>
    </service-template>

    <service-template type="Databases" refresh="default">
        <service_description>list-cache-miss-rate</service_description>
        <service_note>Average number of misses on the list cache</service_note>
        <check-command>check_command   check_marklogic.pl! -a $_HOSTMLUSERPW$  -port $_HOSTMLPORT$  --host $_HOSTMLIP$ -path  /manage/v1/databases/$_HOSTMLALIAS$/status -key $SERVICEDESC$</check-command>
     </service-template>

    <service-template type="Databases" refresh="default">
        <service_description>list-cache-hit-rate</service_description>
        <service_note>Average number of hits on the list cache</service_note>
        <check-command>check_command   check_marklogic.pl! -a $_HOSTMLUSERPW$  -port $_HOSTMLPORT$  --host $_HOSTMLIP$ -path  /manage/v1/databases/$_HOSTMLALIAS$/status -key $SERVICEDESC$</check-command>
    </service-template>

    <service-template type="Databases" refresh="default">
        <service_description>load-detail</service_description>
        <service_note>Moving averages of various loads across attached forests (sec/sec)</service_note>
        <check-command>check_command   check_marklogic.pl! -a $_HOSTMLUSERPW$  -port $_HOSTMLPORT$  --host $_HOSTMLIP$ -path  /manage/v1/databases/$_HOSTMLALIAS$/status -key $SERVICEDESC$</check-command>
    </service-template>

    <service-template type="Databases" refresh="default">
        <service_description>rate-detail</service_description>
        <service_note>Moving averages of various rates across attached forests (sec/sec)</service_note>
        <check-command>check_command   check_marklogic.pl! -a $_HOSTMLUSERPW$  -port $_HOSTMLPORT$  --host $_HOSTMLIP$ -path  /manage/v1/databases/$_HOSTMLALIAS$/status -key $SERVICEDESC$</check-command>
    </service-template>
    
    <service-template type="Databases" refresh="1">
        <service_description>merge-count</service_description>
        <service_note>Number of merges in progress</service_note>
        <check-command>check_command   check_marklogic.pl! -a $_HOSTMLUSERPW$  -port $_HOSTMLPORT$  --host $_HOSTMLIP$ -path  /manage/v1/databases/$_HOSTMLALIAS$/status -key $SERVICEDESC$</check-command>
     </service-template>

    <service-template type="Databases" refresh="10">
        <service_description>on-disk-size</service_description>
        <service_note>Total size of forest data on disk (MB)</service_note>
        <check-command>check_command   check_marklogic.pl! -a $_HOSTMLUSERPW$  -port $_HOSTMLPORT$  --host $_HOSTMLIP$ -path  /manage/v1/databases/$_HOSTMLALIAS$/status -key $SERVICEDESC$</check-command>
    </service-template>

    <service-template type="Databases" refresh="10">
        <service_description>reindex-count</service_description>
        <service_note>Number of reindexes in progress</service_note>
        <check-command>check_command   check_marklogic.pl! -a $_HOSTMLUSERPW$  -port $_HOSTMLPORT$  --host $_HOSTMLIP$ -path  /manage/v1/databases/$_HOSTMLALIAS$/status -key $SERVICEDESC$</check-command>
    </service-template>
    
    <service-template type="Databases" refresh="10">
        <service_description>restore-count</service_description>
        <service_note>Number of restores in progress</service_note>
        <check-command>check_command   check_marklogic.pl! -a $_HOSTMLUSERPW$  -port $_HOSTMLPORT$  --host $_HOSTMLIP$ -path  /manage/v1/databases/$_HOSTMLALIAS$/status -key $SERVICEDESC$</check-command>
     </service-template>   
    
    <service-template type="Hosts" refresh="default">
        <service_description>state-not-open</service_description>
        <service_note>Count of non-open forests on host</service_note>
        <check-command>check_command   check_marklogic.pl! -a $_HOSTMLUSERPW$  -port $_HOSTMLPORT$  --host $_HOSTMLIP$ -path  /manage/v1/forests?view=status\\&amp;host-id=$_HOSTMLALIAS$ -key $SERVICEDESC$</check-command>
        <threshold>
            <default-critical>0:0</default-critical>
        </threshold>
     </service-template>

     <service-template type="Hosts" refresh="default">
        <service_description>max-stands-per-forest</service_description>
        <service_note>Maximum number of stands for a forest on this host</service_note>
        <check-command>check_command   check_marklogic.pl! -a $_HOSTMLUSERPW$  -port $_HOSTMLPORT$  --host $_HOSTMLIP$ -path  /manage/v1/forests?view=status\\&amp;host-id=$_HOSTMLALIAS$ -key $SERVICEDESC$</check-command>
        <threshold>
            <default-critical>50</default-critical>
            <default-warning>@35:50</default-warning>
        </threshold>
     </service-template>

    <service-template type="Hosts" refresh="10">
        <service_description>min-capacity</service_description>
        <service_note>Capacity of the forest with the least available disk space</service_note>
        <check-command>check_command   check_marklogic.pl! -a $_HOSTMLUSERPW$  -port $_HOSTMLPORT$  --host $_HOSTMLIP$ -path  /manage/v1/forests?view=status\\&amp;host-id=$_HOSTMLALIAS$ -key $SERVICEDESC$</check-command>
        <threshold>
            <default-critical>10:</default-critical>
            <default-warning>@10:15</default-warning>
        </threshold>
     </service-template> 

    <service-template type="Hosts" refresh="10">
        <service_description>online</service_description>
        <service_note>Host is online/offline</service_note>
        <check-command>check_command   check_marklogic.pl! -a $_HOSTMLUSERPW$  -port $_HOSTMLPORT$  --host $_HOSTMLIP$ -path  /manage/v1/hosts/$_HOSTMLALIAS$/status -key $SERVICEDESC$ -op eq=true</check-command>
        <threshold>
            <default-critical>1:1</default-critical>
        </threshold>
     </service-template> 
    
    <service-template type="Hosts" refresh="default">
        <service_description>compressed-tree-cache-miss-rate</service_description>
        <service_note>Average number of misses on the compressed tree cache</service_note>
        <check-command>check_command   check_marklogic.pl! -a $_HOSTMLUSERPW$  -port $_HOSTMLPORT$  --host $_HOSTMLIP$ -path  /manage/v1/forests?view=status\\&amp;host-id=$_HOSTMLALIAS$ -key $SERVICEDESC$</check-command>
     </service-template>
    
    <service-template type="Hosts" refresh="default">
        <service_description>compressed-tree-cache-hit-rate</service_description>
        <service_note>Average number of hits on the compressed tree cache</service_note>
        <check-command>check_command   check_marklogic.pl! -a $_HOSTMLUSERPW$  -port $_HOSTMLPORT$  --host $_HOSTMLIP$ -path  /manage/v1/forests?view=status\\&amp;host-id=$_HOSTMLALIAS$ -key $SERVICEDESC$</check-command>
     </service-template>
    
    <service-template type="Hosts" refresh="default">
        <service_description>list-cache-miss-rate</service_description>
        <service_note>Average number of misses on the list cache</service_note>
        <check-command>check_command   check_marklogic.pl! -a $_HOSTMLUSERPW$  -port $_HOSTMLPORT$  --host $_HOSTMLIP$ -path  /manage/v1/forests?view=status\\&amp;host-id=$_HOSTMLALIAS$ -key $SERVICEDESC$</check-command>
    </service-template>

    <service-template type="Hosts" refresh="default">
        <service_description>list-cache-hit-rate</service_description>
        <service_note>Average number of hits on the list cache</service_note>
        <check-command>check_command   check_marklogic.pl! -a $_HOSTMLUSERPW$  -port $_HOSTMLPORT$  --host $_HOSTMLIP$ -path  /manage/v1/forests?view=status\\&amp;host-id=$_HOSTMLALIAS$ -key $SERVICEDESC$</check-command>
    </service-template>

    <service-template type="Hosts" refresh="default">
        <service_description>rate-detail</service_description>
        <service_note>Host Rate Details</service_note>
        <check-command>check_command   check_marklogic.pl! -a $_HOSTMLUSERPW$  -port $_HOSTMLPORT$  --host $_HOSTMLIP$ -path  /manage/v1/hosts/$_HOSTMLALIAS$/status -key $SERVICEDESC$</check-command>
     </service-template>
     
    <service-template type="Hosts" refresh="default">
        <service_description>load-detail</service_description>
        <service_note>Host Load Details</service_note>
        <check-command>check_command   check_marklogic.pl! -a $_HOSTMLUSERPW$  -port $_HOSTMLPORT$  --host $_HOSTMLIP$ -path  /manage/v1/hosts/$_HOSTMLALIAS$/status -key $SERVICEDESC$</check-command>
    </service-template>

</service-templates>
